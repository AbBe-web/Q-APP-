<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questionnaire Q-AAP+</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 100%;
        }
        h1 {
            font-size: 24px;
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        p, .result-message {
            font-size: 14px;
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        .result-message {
            font-size: 16px;
            font-weight: bold;
            margin-top: 20px;
        }
        .question {
            margin-bottom: 15px;
            display: none;
        }
        .question.active {
            display: block;
        }
        .question p {
            margin: 0 0 10px 0;
            font-weight: bold;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="radio"] {
            margin-right: 5px;
        }
        textarea {
            font-size: 12px;
            width: 100%;
            height: 40px;
            resize: none;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px;
        }
        button {
            background-color: #007BFF;
            color: white;
            padding: 10px;
            border: none;
            width: 100%;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        #agePrompt, #activityPrompt {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        #agePrompt input,
        #agePrompt button {
            margin-top: 10px;
        }
        @media print {
            body, .container {
                background-color: white;
                box-shadow: none;
                padding: 20px;
                margin: 0;
                max-width: 100%;
                font-size: 12px;
            }
            h1 {
                font-size: 20px;
            }
            p, .result-message {
                font-size: 12px;
            }
            button, .actions {
                display: none;
            }
            .container {
                page-break-inside: avoid;
            }
            .question label {
                display: none;
            }
            .question input[type="radio"]:checked + span {
                display: inline;
            }
            .question input[type="radio"]:not(:checked) + span {
                display: none;
            }
            .question textarea {
                display: none;
            }
            .question .answer {
                display: block;
                font-size: 12px;
                margin-top: 5px;
                color: #555;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Questionnaire Q-AAP+</h1>
        <p>Ce questionnaire s'adresse aux personnes de 15 à 69 ans voulant augmenter leur niveau d'activité physique. Bravo à vous ;-) L'objectif est de savoir s'il est souhaitable d'avoir un avis médical avant de vous lancer. Lisez les questions et répondez honnêtement par "Oui" ou "Non".</p>
        <form id="qAppPlusForm">
            <div class="question active">
                <p>1. Votre médecin vous a dit que vous étiez atteint d’un problème cardiaque ou d’une hypertension ?</p>
                <label><input type="radio" name="q1" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q1" value="0"><span> Non</span></label>
                <div class="answer"></div>
            </div>
            <div class="question">
                <p>2. Ressentez-vous une douleur à la poitrine au repos, ou au cours de vos activités quotidiennes ou lorsque vous faites de l’activité physique ?</p>
                <label><input type="radio" name="q2" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q2" value="0"><span> Non</span></label>
                <div class="answer"></div>
            </div>
            <div class="question">
                <p>3. Éprouvez-vous des pertes d’équilibre liées à des étourdissements ou avez-vous perdu conscience au cours des 12 derniers mois ?</p>
                <label><input type="radio" name="q3" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q3" value="0"><span> Non</span></label>
                <div class="answer"></div>
            </div>
            <div class="question">
                <p>4. Avez-vous déjà été diagnostiqué d’une autre maladie chronique (autre qu’une maladie cardiaque ou d’hypertension artérielle) ?</p>
                <label><input type="radio" name="q4" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q4" value="0"><span> Non</span></label>
                <textarea name="q4_details" placeholder="Listez les maladies ici"></textarea>
                <div class="answer"></div>
            </div>
            <div class="question">
                <p>5. Prenez-vous actuellement des médicaments prescrits pour une maladie chronique ?</p>
                <label><input type="radio" name="q5" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q5" value="0"><span> Non</span></label>
                <textarea name="q5_details" placeholder="Listez les médicaments ici"></textarea>
                <div class="answer"></div>
            </div>
            <div class="question">
                <p>6. Avez-vous actuellement des problèmes osseux, articulaires, ou des tissus mous qui pourraient être aggravés par une augmentation d’activité physique ?</p>
                <label><input type="radio" name="q6" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q6" value="0"><span> Non</span></label>
                <textarea name="q6_details" placeholder="Listez vos problèmes ici"></textarea>
                <div class="answer"></div>
            </div>
            <div class="question">
                <p>7. Votre médecin vous a-t-il déjà dit que vous ne devriez pas faire d’activité physique sans supervision médicale ?</p>
                <label><input type="radio" name="q7" value="1"><span> Oui</span></label>
                <label><input type="radio" name="q7" value="0"><span> Non</span></label>
                <div class="answer"></div>
            </div>
            <div class="personal-info">
                <input type="text" id="firstName" placeholder="Prénom" required>
                <input type="text" id="lastName" placeholder="Nom" required>
                <p>Date : <span id="currentDate"></span></p>
            </div>
            <button type="button" onclick="submitForm()">Soumettre</button>
            <div id="agePrompt" style="display: none;">
                <p>Quel est votre âge ?</p>
                <input type="number" id="userAge" placeholder="Âge" min="1">
                <button type="button" onclick="submitAge()">Soumettre</button>
            </div>
            <div id="activityPrompt" style="display: none;">
                <p>Quel niveau d'activité physique souhaitez-vous faire ?</p>
                <label><input type="radio" name="activityLevel" value="modéré"><span> Modéré : vous êtes essoufflé mais pouvez encore parler en faisant des phrases complètes</span></label>
                <label><input type="radio" name="activityLevel" value="intense"><span> Intense ou très intense : vous ne pouvez pas prononcer plus que quelques mots voire aucun</span></label>
                <button type="button" onclick="submitActivity()">Soumettre</button>
            </div>
            <div class="result-message"></div>
            <div class="actions">
                <button type="button" onclick="printDocument()">Imprimer</button>
            </div>
        </form>
    </div>
    <script>
        let totalScore = 0;

        document.addEventListener('DOMContentLoaded', function () {
            const currentDate = new Date();
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            document.getElementById('currentDate').textContent = currentDate.toLocaleDateString('fr-FR', options);

            const questions = document.querySelectorAll('.question');
            questions[0].classList.add('active');

            questions.forEach((question, index) => {
                question.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', () => {
                        if (index < questions.length - 1) {
                            questions[index + 1].classList.add('active');
                            questions[index + 1].scrollIntoView({ behavior: 'smooth' });
                        }
                    });
                });
            });
        });

        function submitForm() {
            const form = document.forms['qAppPlusForm'];
            const requiredQuestions = ['q1', 'q2', 'q3', 'q4', 'q5', 'q6', 'q7'];
            const allRequiredQuestionsAnswered = requiredQuestions.every(name => form.querySelector(`input[name="${name}"]:checked`));
            const resultMessage = document.querySelector('.result-message');

            if (!allRequiredQuestionsAnswered) {
                alert("Veuillez répondre à toutes les questions par 'Oui' ou 'Non' avant de soumettre le formulaire.");
                return;
            }

            totalScore = Array.from(form.querySelectorAll('input[type="radio"]:checked')).reduce((sum, radio) => sum + parseInt(radio.value), 0);
            resultMessage.textContent = `Votre score au questionnaire Q-AAP+ est de ${totalScore}. `;

            let hasYes = Array.from(form.querySelectorAll('input[type="radio"]:checked')).some(radio => radio.value === '1');

            if (hasYes) {
                resultMessage.textContent += "Vous avez répondu oui à au moins une des questions. Consultez votre médecin avant d'augmenter votre niveau d'activité physique.";
                resultMessage.scrollIntoView({ behavior: 'smooth' });
            } else {
                document.getElementById('agePrompt').style.display = 'block';
                document.getElementById('agePrompt').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function submitAge() {
            const age = parseInt(document.getElementById('userAge').value);
            const resultMessage = document.querySelector('.result-message');

            if (isNaN(age) || age < 1) {
                alert("Veuillez entrer un âge valide.");
                return;
            }

            document.getElementById('agePrompt').style.display = 'none';

            if (age < 45) {
                resultMessage.textContent = `Votre score au questionnaire Q-AAP+ est de ${totalScore}. Vous pouvez donc augmenter progressivement votre niveau d'activité physique. Un avis médical préalable n'est pas recommandé selon le guide de l'HAS Consultation et prescription médicale d’activité physique à des fins de santé chez l’adulte.`;
                resultMessage.scrollIntoView({ behavior: 'smooth' });
            } else {
                document.getElementById('activityPrompt').style.display = 'block';
                document.getElementById('activityPrompt').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function submitActivity() {
            const activityLevel = document.querySelector('input[name="activityLevel"]:checked');
            const resultMessage = document.querySelector('.result-message');

            if (!activityLevel) {
                alert("Veuillez sélectionner un niveau d'activité physique.");
                return;
            }

            document.getElementById('activityPrompt').style.display = 'none';

            if (activityLevel.value === 'modéré') {
                resultMessage.textContent = `Votre score au questionnaire Q-AAP+ est de ${totalScore} et vous avez choisi de pratiquer une activité physique d'intensité modérée. Vous pouvez donc augmenter progressivement votre niveau d'activité physique. Un avis médical préalable n'est pas recommandé selon le guide de l'HAS Consultation et prescription médicale d’activité physique à des fins de santé chez l’adulte.`;
            } else {
                resultMessage.textContent = `Votre score au questionnaire Q-AAP+ est de ${totalScore} mais vous avez choisi de pratiquer une activité physique d'intensité élevée ou très élevée, il est recommandé de consulter votre médecin avant d'augmenter votre niveau d'activité physique selon le guide de l'HAS "Consultation et prescription médicale d’activité physique à des fins de santé chez l’adulte".`;
            }
            resultMessage.scrollIntoView({ behavior: 'smooth' });
        }

        function printDocument() {
            const form = document.forms['qAppPlusForm'];
            const answers = form.querySelectorAll('.question');
            answers.forEach(question => {
                const radio = question.querySelector('input[type="radio"]:checked');
                const answerText = radio ? radio.nextElementSibling.textContent.trim() : '';
                const details = question.querySelector('textarea')?.value.trim() || '';
                const answerDiv = question.querySelector('.answer');
                answerDiv.textContent = answerText;
                if (details) {
                    answerDiv.textContent += ` (${details})`;
                }
            });
            window.print();
        }
    </script>
</body>
</html>
